<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Multi Domain Setup | Harbourmaster Single Sign On (SSO)</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./harbourmaster.html" />
    
    
    <link rel="prev" href="./quick-start-guide.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="2"
        data-chapter-title="Multi Domain Setup"
        data-filepath="multidomainsetup.md"
        data-basepath="."
        data-revision="Mon Sep 19 2016 14:02:43 GMT+0200 (CEST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        README
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="quick-start-guide.html">
            
                
                    <a href="./quick-start-guide.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Quick Start Guide
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2" data-path="multidomainsetup.html">
            
                
                    <a href="./multidomainsetup.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Multi Domain Setup
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="harbourmaster.html">
            
                
                    <a href="./harbourmaster.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Harbourmaster
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="Usermanager.html">
            
                
                    <a href="./Usermanager.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Usermanager
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="control-center.html">
            
                
                    <a href="./control-center.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Control Center
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="drupalmodule.html">
            
                
                    <a href="./drupalmodule.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Drupal Module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="license.html">
            
                
                    <a href="./license.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        LICENSE
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Harbourmaster Single Sign On (SSO)</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="quick-start-guide-multi-domain-setup"><a href="quick-start-guide.html">Quick Start Guide</a> Multi Domain Setup</h1>
<p>With Harbourmaster it is possible allow users to login with the same username and password on multiple top level domains e.g. <code>tunder.dev</code> and <code>thunder.local</code>. This requires to set up multiple usermanagers, each dedicated to their own domain but each communicating with the same Harbourmaster. This setup allows for the most customization since each usermanager can be configured individually (see chapter <a href="Usermanager.html">Usermanager)</a>.</p>
<p><img src="assets/multiple_domain_overview.png" alt=""></p>
<p>It is possible to automatically log in users on all SSO domains with one single login action, also known as <strong>cross domain login</strong>. This feature relies on third-party cookies (setting a cookie on a domain which the user is not currently visiting). Some browser block third-party cookies, which is why this feature is not compatible with all browsers.</p>
<p>This guide aims to provide you with a quick way to set up a local multi usermanager installation. It is assumed that you have followed our <a href="quick-start-guide.html">Quick Start Guide</a> to the point where the Harbourmaster, Usermanager and Controlcenter are all running on your system.</p>
<h2 id="adding-a-second-usermanager-to-the-quick-start-guide">Adding a second Usermanager to the <a href="quick-start-guide.html">Quick Start Guide</a></h2>
<p>The Harbourmaster quick start repository comes with the <a href="quickstart/docker-compose-second-domain.yml">docker-compose-second-domain.yml</a> which is pre-configured to add a second Usermanager to the <a href="quick-start-guide.html">Quick Start Guide</a>. This Usermanager will be running under the <code>usermanager.thunder.local</code> domain.</p>
<p>Stop the docker-compose run from the Quick Start Guide and start it again with providing both docker compose files</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> harbourmaster-docs/quickstart/
docker-compose <span class="hljs-operator">-f</span> docker-compose.yml <span class="hljs-operator">-f</span> docker-compose-second-domain.yml up
</code></pre>
<p><strong>Add /etc/hosts entries</strong></p>
<p>Create the following entry in your /etc/hosts file. If the second Usermanager&apos;s Docker container is running non-locally, replace the IP address in this entry accordingly.</p>
<pre><code class="lang-bash"><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> usermanager.thunder.local www.thunder.local
</code></pre>
<h3 id="accessing-the-applications">Accessing the applications</h3>
<p>To access your second Usermanager, simply point your web browser to <a href="http://usermanager.thunder.local/demo/" target="_blank">http://usermanager.thunder.local/demo/</a>.</p>
<p>You should now have two Usermanagers running under two different domains: <code>thunder.local</code> and <code>thunder.dev</code>. Both Usermanagers are communicating with the same Harbourmaster, allowing users to log in accross multiple domains.</p>
<p>In your production setup, you will have to customize each Usermanager&apos;s configuration. Please refer to the configuration section of the <a href="Usermanager.html">Usermanager</a> chapter, especially regarding the variables <code>SSO_WIDGET_CORS_HTTP_HOSTS</code> and <code>CROSS_DOMAIN_LOGIN_BASE_URL</code>, as these are required to be set according to your setup.</p>
<p><em>Note concerning the Drupal Module installation: In the <strong>URL to usermanager</strong> option, use <a href="http://usermanager.thunder.local" target="_blank">http://usermanager.thunder.local</a></em></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./quick-start-guide.html" class="navigation navigation-prev " aria-label="Previous page: Quick Start Guide"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./harbourmaster.html" class="navigation navigation-next " aria-label="Next page: Harbourmaster"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"ga":{"token":"UA-83785947-1","configuration":"auto"},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
